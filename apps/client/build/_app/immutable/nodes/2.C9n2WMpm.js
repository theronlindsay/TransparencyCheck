import{d as $e,a as n,f as v,c as je}from"../chunks/B0XpXUNy.js";import{$ as et,a0 as l,a1 as a,a2 as r,ay as Be,a4 as tt,a3 as W,a5 as u,ad as Ye,V as Qe,d as e,a6 as s,az as J,an as $}from"../chunks/DmPSzBqa.js";import{s as G}from"../chunks/CWZleTfL.js";import{i as p}from"../chunks/CLo8OjLx.js";import{e as pt,i as ht}from"../chunks/BwzCRPuz.js";import{s as _t}from"../chunks/DgCCDCx9.js";import{B as ft}from"../chunks/CQ_L7bua.js";import{r as Le}from"../chunks/SVnnPJKx.js";import{b as De,c as qe,d as mt,a as Ze}from"../chunks/PRPOCrtn.js";import{p as O}from"../chunks/lJDnNygf.js";var bt=v('<div class="results-summary svelte-yz6t64"><p class="svelte-yz6t64"> </p></div>'),yt=v('<div class="filter-panel svelte-yz6t64"><div class="filter-header svelte-yz6t64"><h3 class="svelte-yz6t64">Filters</h3> <button class="reset-button svelte-yz6t64">Reset All</button></div> <div class="filter-grid svelte-yz6t64"><div class="filter-group full-width svelte-yz6t64"><label for="search" class="svelte-yz6t64">Search Bills</label> <input type="text" id="search" placeholder="Search by title, bill number, or description..." class="svelte-yz6t64"/></div> <div class="filter-group svelte-yz6t64"><label for="status" class="svelte-yz6t64">Status</label> <select id="status" class="svelte-yz6t64"><option>All Status</option><option>Introduced</option><option>In Committee</option><option>Passed House</option><option>Passed Senate</option><option>Enacted</option><option>Vetoed</option><option>Failed</option></select></div> <div class="filter-group svelte-yz6t64"><label for="chamber" class="svelte-yz6t64">Origin Chamber</label> <select id="chamber" class="svelte-yz6t64"><option>All Chambers</option><option>House</option><option>Senate</option></select></div> <div class="filter-group svelte-yz6t64"><label for="sponsor" class="svelte-yz6t64">Sponsor</label> <input type="text" id="sponsor" placeholder="Search by sponsor name..." class="svelte-yz6t64"/></div> <div class="filter-group svelte-yz6t64"><label for="itemsPerPage" class="svelte-yz6t64">Items Per Page</label> <select id="itemsPerPage" class="svelte-yz6t64"><option>10</option><option>25</option><option>50</option><option>100</option></select></div> <div class="filter-group svelte-yz6t64"><label for="dateFrom" class="svelte-yz6t64">Introduced From</label> <input type="date" id="dateFrom" class="svelte-yz6t64"/></div> <div class="filter-group svelte-yz6t64"><label for="dateTo" class="svelte-yz6t64">Introduced To</label> <input type="date" id="dateTo" class="svelte-yz6t64"/></div> <div class="filter-group checkbox-group svelte-yz6t64"><label class="checkbox-label svelte-yz6t64"><input type="checkbox" class="svelte-yz6t64"/> <span class="svelte-yz6t64">Search Congress.gov if needed</span></label> <p class="checkbox-hint svelte-yz6t64">Automatically search Congress.gov when local results are limited</p></div></div> <!></div>');function Ft(Ue,f){et(f,!0);let y=O(f,"searchQuery",15,""),F=O(f,"statusFilter",15,"all"),S=O(f,"chamberFilter",15,"all"),x=O(f,"sponsorFilter",15,""),z=O(f,"dateFrom",15,""),P=O(f,"dateTo",15,""),w=O(f,"itemsPerPage",15,25),m=O(f,"searchCongress",15,!1),o=O(f,"resultsSummary",3,""),N=O(f,"onReset",3,()=>{});function R(){y(""),F("all"),S("all"),x(""),z(""),P(""),w(25),m(!1),N()&&N()()}var d=yt(),C=l(d),K=a(l(C),2);K.__click=R,r(C);var ee=a(C,2),L=l(ee),V=a(l(L),2);Le(V),r(L);var fe=a(L,2),me=a(l(fe),2),B=l(me);B.value=B.__value="all";var le=a(B);le.value=le.__value="Introduced";var k=a(le);k.value=k.__value="In Committee";var oe=a(k);oe.value=oe.__value="Passed House";var Q=a(oe);Q.value=Q.__value="Passed Senate";var be=a(Q);be.value=be.__value="Enacted";var ie=a(be);ie.value=ie.__value="Vetoed";var Ie=a(ie);Ie.value=Ie.__value="Failed",r(me),r(fe);var ye=a(fe,2),te=a(l(ye),2),ne=l(te);ne.value=ne.__value="all";var ae=a(ne);ae.value=ae.__value="House";var ve=a(ae);ve.value=ve.__value="Senate",r(te),r(ye);var Fe=a(ye,2),ce=a(l(Fe),2);Le(ce),r(Fe);var ue=a(Fe,2),se=a(l(ue),2),Se=l(se);Se.value=Se.__value=10;var xe=a(Se);xe.value=xe.__value=25;var ze=a(xe);ze.value=ze.__value=50;var Ae=a(ze);Ae.value=Ae.__value=100,r(se),r(ue);var t=a(ue,2),i=a(l(t),2);Le(i),r(t);var I=a(t,2),de=a(l(I),2);Le(de),r(I);var X=a(I,2),b=l(X),A=l(b);Le(A),Be(2),r(b),Be(2),r(X),r(ee);var M=a(ee,2);{var j=D=>{var U=bt(),re=l(U),ge=l(re,!0);r(re),r(U),W(()=>G(ge,o())),n(D,U)};p(M,D=>{o()&&D(j)})}r(d),De(V,y),qe(me,F),qe(te,S),De(ce,x),qe(se,w),De(i,z),De(de,P),mt(A,m),n(Ue,d),tt()}$e(["click"]);var St=v('<div class="loading-message svelte-1uha8ag"><div class="spinner svelte-1uha8ag"></div> <p>Loading bills...</p></div>'),xt=v('<div class="error-message svelte-1uha8ag"><p> </p></div>'),zt=v('<div class="empty-message svelte-1uha8ag"><p>No bills found in the database.</p></div>'),Pt=v('<div class="congress-prompt svelte-1uha8ag"><p class="svelte-1uha8ag"><strong> </strong></p> <p class="svelte-1uha8ag">Enable "Search Congress.gov if needed" in filters to automatically search for more bills.</p></div>'),wt=v('<div class="loading-message svelte-1uha8ag"><div class="spinner svelte-1uha8ag"></div> <p>Searching Congress.gov for matching bills...</p></div>'),Ct=v('<p>No bills found on Congress.gov matching your filters.</p> <button class="reset-search-button svelte-1uha8ag">Back to Local Results</button>',1),kt=v('<p>No bills match the current filters in the local database.</p> <p class="empty-hint svelte-1uha8ag">Enable "Search Congress.gov if needed" in filters to automatically search when results are limited.</p>',1),Tt=v('<div class="empty-message svelte-1uha8ag"><!></div>'),Rt=v('<div class="loading-footer svelte-1uha8ag"><div class="spinner-small svelte-1uha8ag"></div> <p class="svelte-1uha8ag">Loading more bills from Congress.gov...</p></div>'),Lt=v('<span class="ellipsis svelte-1uha8ag">...</span>'),Bt=v('<button class="page-button svelte-1uha8ag">1</button> <!>',1),It=v('<button class="page-button svelte-1uha8ag"> </button>'),At=v('<button class="page-button svelte-1uha8ag"> </button>'),Et=v('<span class="ellipsis svelte-1uha8ag">...</span>'),Nt=v('<!> <button class="page-button svelte-1uha8ag"> </button>',1),Qt=v('<div class="pagination svelte-1uha8ag"><button class="page-button svelte-1uha8ag">Previous</button> <div class="page-numbers svelte-1uha8ag"><!> <!> <button class="page-button active svelte-1uha8ag" disabled> </button> <!> <!></div> <button class="page-button svelte-1uha8ag">Next</button></div>'),Dt=v('<div class="bills-grid svelte-1uha8ag"></div> <!> <!>',1),Ut=v("<div><!></div> <!> <!>",1),Ht=v('<div class="content svelte-1uha8ag"><div class="hero-section svelte-1uha8ag"><h2 class="svelte-1uha8ag">Welcome to Transparency Check</h2> <p class="svelte-1uha8ag">Track and monitor congressional bills and legislative transparency.</p></div> <section class="recent-bills-section svelte-1uha8ag"><div class="filter-header-mobile svelte-1uha8ag"><h3 class="svelte-1uha8ag">Recently Updated Bills</h3> <button class="filter-toggle svelte-1uha8ag" aria-label="Toggle filters"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1uha8ag"><line x1="4" y1="6" x2="20" y2="6"></line><line x1="4" y1="12" x2="20" y2="12"></line><line x1="4" y1="18" x2="20" y2="18"></line></svg> </button></div> <div class="filter-header-desktop svelte-1uha8ag"><div class="header-row svelte-1uha8ag"><h3 class="svelte-1uha8ag">Recently Updated Bills</h3> <button class="filter-toggle svelte-1uha8ag" aria-label="Toggle filters"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1uha8ag"><line x1="4" y1="6" x2="20" y2="6"></line><line x1="4" y1="12" x2="20" y2="12"></line><line x1="4" y1="18" x2="20" y2="18"></line></svg> </button></div> <br/></div> <!></section></div>');function Yt(Ue,f){et(f,!0);let y=u(Ye([])),F=u(""),S=u("all"),x=u("all"),z=u(""),P=u(""),w=u(""),m=u(25),o=u(1),N=u(!1),R=u(!1),d=u(Ye([])),C=u(!1),K=u(!1),ee=u(!1),L=u(!1),V=u(null);const fe={capture:()=>({billsData:e(y),searchQuery:e(F),statusFilter:e(S),chamberFilter:e(x),sponsorFilter:e(z),dateFrom:e(P),dateTo:e(w),itemsPerPage:e(m),currentPage:e(o),showFilters:e(N),isSearching:e(R),serverSearchResults:e(d),hasSearched:e(C),searchCongress:e(K),isLoading:e(L),error:e(V)}),restore:t=>{s(y,t.billsData,!0),s(F,t.searchQuery,!0),s(S,t.statusFilter,!0),s(x,t.chamberFilter,!0),s(z,t.sponsorFilter,!0),s(P,t.dateFrom,!0),s(w,t.dateTo,!0),s(m,t.itemsPerPage,!0),s(o,t.currentPage,!0),s(N,t.showFilters,!0),s(R,t.isSearching,!0),s(d,t.serverSearchResults,!0),s(C,t.hasSearched,!0),s(K,t.searchCongress,!0),s(L,t.isLoading,!0),s(V,t.error,!0)}};async function me(){try{const t=await fetch(Ze("/api/bills"));if(!t.ok)throw new Error(`Failed to fetch bills: ${t.status}`);const i=await t.json();s(y,i,!0),s(L,!1)}catch(t){console.error("Error fetching bills:",t),s(V,t.message,!0),s(L,!1)}}Qe(()=>{e(y).length===0&&!e(V)&&!e(L)&&(s(L,!0),me())});let B=J(()=>()=>e(d).length>0?e(d):!e(y)||e(y).length===0?[]:e(y).filter(t=>{if(e(F)){const i=e(F).toLowerCase();if(!(t.title?.toLowerCase().includes(i)||t.billNumber?.toLowerCase().includes(i)||t.policyArea?.toLowerCase().includes(i)))return!1}if(e(S)!=="all"&&t.status!==e(S)||e(x)!=="all"&&t.originChamber!==e(x))return!1;if(e(z)){const i=e(z).toLowerCase();if(!(t.sponsors||"").toLowerCase().includes(i))return!1}return!(e(P)&&t.introducedDate<e(P)||e(w)&&t.introducedDate>e(w))})),le=J(()=>()=>{const t=e(B)(),i=(e(o)-1)*e(m),I=i+e(m);return t.slice(i,I)}),k=J(()=>Math.ceil((e(B)()?.length||0)/e(m)));Qe(()=>{const t=e(B)();t.length<10&&t.length>0&&!e(R)&&!e(C)&&!e(d).length?s(ee,!0):s(ee,!1)}),Qe(()=>{const t=e(B)();e(K)&&t.length<10&&!e(R)&&!e(C)&&!e(d).length&&be()}),Qe(()=>{e(F),e(S),e(x),e(z),e(P),e(w),e(m),s(o,1)});function oe(){s(N,!e(N))}function Q(t){t>=1&&t<=e(k)&&(s(o,t,!0),window.scrollTo({top:0,behavior:"smooth"}))}async function be(){s(R,!0),s(C,!1),s(d,[],!0),s(o,1);try{const t=new URLSearchParams;e(F)&&t.append("search",e(F)),e(S)!=="all"&&t.append("status",e(S)),e(x)!=="all"&&t.append("chamber",e(x)),e(z)&&t.append("sponsor",e(z)),e(P)&&t.append("dateFrom",e(P)),e(w)&&t.append("dateTo",e(w)),t.append("stream","true");const i=await fetch(Ze(`/api/search-bills?${t.toString()}`));if(console.log("Response status:",i.status),console.log("Response headers:",i.headers.get("Content-Type")),i.ok&&i.body){const I=i.body.getReader(),de=new TextDecoder;let X="";try{for(;;){const{done:b,value:A}=await I.read();if(b){console.log("Stream completed");break}X+=de.decode(A,{stream:!0});const M=X.split(`
`);X=M.pop()||"";for(const j of M)if(j.trim())try{const D=JSON.parse(j);console.log("Received bill:",D.billNumber),s(d,[...e(d),D],!0)}catch(D){console.error("Error parsing bill:",D,"Line:",j)}}}catch(b){console.error("Stream reading error:",b)}s(C,!0)}else console.error("Response not ok or no body")}catch(t){console.error("Server search failed:",t)}finally{s(R,!1),console.log("Search completed, total bills:",e(d).length)}}function ie(){s(d,[],!0),s(C,!1)}function Ie(){ie()}var ye={snapshot:fe},te=Ht(),ne=a(l(te),2),ae=l(ne),ve=a(l(ae),2);ve.__click=oe;var Fe=a(l(ve));r(ve),r(ae);var ce=a(ae,2),ue=l(ce),se=a(l(ue),2);se.__click=oe;var Se=a(l(se));r(se),r(ue),Be(2),r(ce);var xe=a(ce,2);{var ze=t=>{var i=St();n(t,i)},Ae=t=>{var i=je(),I=$(i);{var de=b=>{var A=xt(),M=l(A),j=l(M);r(M),r(A),W(()=>G(j,`Error loading bills: ${e(V)??""}`)),n(b,A)},X=b=>{var A=je(),M=$(A);{var j=U=>{var re=zt();n(U,re)},D=U=>{var re=Ut(),ge=$(re);let Je;var at=l(ge);{let T=J(()=>(e(o)-1)*e(m)+1),H=J(()=>Math.min(e(o)*e(m),e(B)().length)),pe=J(()=>e(B)().length);Ft(at,{get resultsSummary(){return`Showing ${e(T)??""}-${e(H)??""} of ${e(pe)??""} bills`},onReset:Ie,get searchQuery(){return e(F)},set searchQuery(c){s(F,c,!0)},get statusFilter(){return e(S)},set statusFilter(c){s(S,c,!0)},get chamberFilter(){return e(x)},set chamberFilter(c){s(x,c,!0)},get sponsorFilter(){return e(z)},set sponsorFilter(c){s(z,c,!0)},get dateFrom(){return e(P)},set dateFrom(c){s(P,c,!0)},get dateTo(){return e(w)},set dateTo(c){s(w,c,!0)},get itemsPerPage(){return e(m)},set itemsPerPage(c){s(m,c,!0)},get searchCongress(){return e(K)},set searchCongress(c){s(K,c,!0)}})}r(ge);var We=a(ge,2);{var st=T=>{var H=Pt(),pe=l(H),c=l(pe),He=l(c);r(c),r(pe),Be(2),r(H),W(Y=>G(He,`Limited results found (${Y??""} bills)`),[()=>e(B)().length]),n(T,H)};p(We,T=>{e(ee)&&!e(K)&&T(st)})}var rt=a(We,2);{var lt=T=>{var H=wt();n(T,H)},ot=T=>{var H=je(),pe=$(H);{var c=Y=>{var he=Tt(),Pe=l(he);{var Ee=Z=>{var _e=Ct(),E=a($(_e),2);E.__click=ie,n(Z,_e)},Oe=Z=>{var _e=kt();Be(2),n(Z,_e)};p(Pe,Z=>{e(C)?Z(Ee):Z(Oe,!1)})}r(he),n(Y,he)},He=Y=>{var he=Dt(),Pe=$(he);pt(Pe,21,()=>e(le)(),ht,(E,g)=>{{let we=J(()=>e(g).billNumber||e(g).number),Ce=J(()=>e(g).primaryCommitteeName||"Unassigned"),Ne=J(()=>e(g).status||e(g).statusTag);ft(E,{get id(){return e(g).id},get number(){return e(we)},get title(){return e(g).title},get sponsors(){return e(g).sponsors},get committee(){return e(Ce)},get statusTag(){return e(Ne)},get latestAction(){return e(g).latestAction},get updatedAt(){return e(g).updateDate}})}}),r(Pe);var Ee=a(Pe,2);{var Oe=E=>{var g=Rt();n(E,g)};p(Ee,E=>{e(R)&&E(Oe)})}var Z=a(Ee,2);{var _e=E=>{var g=Qt(),we=l(g);we.__click=()=>Q(e(o)-1);var Ce=a(we,2),Ne=l(Ce);{var it=h=>{var _=Bt(),q=$(_);q.__click=()=>Q(1);var Me=a(q,2);{var ke=Te=>{var Re=Lt();n(Te,Re)};p(Me,Te=>{e(o)>3&&Te(ke)})}n(h,_)};p(Ne,h=>{e(o)>2&&h(it)})}var Ge=a(Ne,2);{var nt=h=>{var _=It();_.__click=()=>Q(e(o)-1);var q=l(_,!0);r(_),W(()=>G(q,e(o)-1)),n(h,_)};p(Ge,h=>{e(o)>1&&h(nt)})}var Ve=a(Ge,2),vt=l(Ve,!0);r(Ve);var Ke=a(Ve,2);{var ct=h=>{var _=At();_.__click=()=>Q(e(o)+1);var q=l(_,!0);r(_),W(()=>G(q,e(o)+1)),n(h,_)};p(Ke,h=>{e(o)<e(k)&&h(ct)})}var ut=a(Ke,2);{var dt=h=>{var _=Nt(),q=$(_);{var Me=Re=>{var gt=Et();n(Re,gt)};p(q,Re=>{e(o)<e(k)-2&&Re(Me)})}var ke=a(q,2);ke.__click=()=>Q(e(k));var Te=l(ke,!0);r(ke),W(()=>G(Te,e(k))),n(h,_)};p(ut,h=>{e(o)<e(k)-1&&h(dt)})}r(Ce);var Xe=a(Ce,2);Xe.__click=()=>Q(e(o)+1),r(g),W(()=>{we.disabled=e(o)===1,G(vt,e(o)),Xe.disabled=e(o)===e(k)}),n(E,g)};p(Z,E=>{e(k)>1&&E(_e)})}n(Y,he)};p(pe,Y=>{e(le)().length===0&&!e(R)?Y(c):Y(He,!1)},!0)}n(T,H)};p(rt,T=>{e(R)&&e(d).length===0?T(lt):T(ot,!1)})}W(()=>Je=_t(ge,1,"filter-container svelte-1uha8ag",null,Je,{hidden:!e(N)})),n(U,re)};p(M,U=>{!e(y)||e(y).length===0?U(j):U(D,!1)})}n(b,A)};p(I,b=>{e(V)?b(de):b(X,!1)},!0)}n(t,i)};p(xe,t=>{e(L)?t(ze):t(Ae,!1)})}return r(ne),r(te),W(()=>{G(Fe,` Filters ${e(N)?"▲":"▼"}`),G(Se,` Filters ${e(N)?"▲":"▼"}`)}),n(Ue,te),tt(ye)}$e(["click"]);export{Yt as component};
